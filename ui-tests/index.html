<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"> 
<script type="text/javascript" src="sha512.js"></script>
<script src="https://code.jquery.com/jquery-3.2.0.min.js"></script>

<script type="text/javascript" >
  function sha512(str) {
    return crypto.subtle.digest("SHA-512", new TextEncoder("utf-8").encode(str)).then(buf => {
      return Array.prototype.map.call(new Uint8Array(buf), x=>(('00'+x.toString(16)).slice(-2))).join('');
    });
  }

  function onPass(event) {
    event = event || window.event;
    if (event.keyCode != 13) {
      return;
    }

    var pass = $("#pass").val();
    var url = window.location.href + sha512(pass) + "/index.html";
    $("#status").text("...");

    $.ajax({
      type: 'HEAD',
      url: url,
      success: function() {
        var iframe = $("#iframe");
        iframe.css("display", "inherit");
        iframe.attr("src", url);
        $("#prompt").css("display", "none");
      },
      error: function() {
        $("#status").text("ERROR!");
      }
    });
  }
</script>

<style>
  body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; }
  #content { position:absolute; left: 0; right: 0; bottom: 0; top: 0px; }
  #iframe { display: none; }
  #prompt { margin-left: 1%; }
</style>
</head>

<body>
  <div id="content">
    <div id="prompt">
      <p>
      Enter password: 
      <input type="password" onkeyup="onPass(event)" id="pass">
      <span id="status"></span>
      </p>
    </div>
    <iframe id="iframe" width="100%" height="100%" frameborder="0" />
  </div>
</body>
</html>
